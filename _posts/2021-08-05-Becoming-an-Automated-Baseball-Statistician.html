<p>5/28/21</p><p>Hello readers!</p><p>Sorry it has been so long since I posted last. May was very busy.</p><p>This is honestly the first post that truly encapsulates what I will be using this blog for: merging sports and computer science. Today we will look into the hot topic of baseball stats and not only how they are calculated, but more importantly, how they can be calculated with efficiency. Let's just say it is not enjoyable to manually calculate some baseball stats, but we can do so automatically using Python programming and existing data available on the Internet!</p><p>Here we go! Let's outline the steps necessary to become an automated baseball statistician.<br></p><ol><li>Set up a workspace to use our data as input into a program</li><li>Collect existing baseball data (we will be using data from the 2019 MLB Season found on&nbsp;<a href="https://www.baseball-reference.com/"><u>https://www.baseball-reference.com/</u></a></li><li>Find formulas to calculate our desired stats<br></li><li>Create a program that reads our data (input) and calculates then outputs our desired stats</li></ol><p><strong>Setup a workspace</strong></p><p>Whenever I work with programming like we will doing today, I always work in Visual Studio Code (VSC). Much like its friend Visual Studio developed by the same company, Microsoft, VSC specializes in coding and even has really good development and extension features. I recommend downloading it to make a workspace where our data is easily accessible:&nbsp;<a href="https://code.visualstudio.com/Download"><u>https://code.visualstudio.com/Download</u></a>.</p><p>Once you have downloaded VSC, if you do not have Python installed already, please use this link to download its software:&nbsp;<a href="https://www.python.org/downloads"><u>https://www.python.org/downloads</u></a>. I recommend downloading the latest version available. If you are unsure, just download a 3.7 or 3.8 version.</p><p>Create a folder on your computer for this project and if you right-click on it, you should get the option to "Open with Code". Click on this to see your folder open in VSC's folder explorer on the left-hand side. You will want to make 2 new files right away in this folder.</p><ol><li>batter_data.csv</li><li>pitcher_data.csv</li></ol><p>Click the "New File" button next to the folder name to create a new file. This folder will eventually have 6 files total: two more .csv and two .py files from GitHub.<br></p><div class="tss_actions"></div><p><strong>Collect existing baseball data</strong></p><p>For this article and teaching purposes, I will be using two sets of customized data from Baseball Reference. These are the two sets:</p><ul><li>2019 MLB Standard Batting Stats:&nbsp;<a href="https://www.baseball-reference.com/leagues/MLB/2019-standard-batting.shtml"><u>https://www.baseball-reference.com/leagues/MLB/2019-standard-batting.shtml</u></a></li><li>2019 MLB Standard Pitching Stats:&nbsp;<a href="https://www.baseball-reference.com/leagues/MLB/2019-standard-pitching.shtml"><u>https://www.baseball-reference.com/leagues/MLB/2019-standard-pitching.shtml</u></a></li></ul><p>I used these two data sets and customized them for the purpose of this article. I did so by clicking the "Share &amp; Export" dropdown menu and choosing "Modify, Export &amp; Share Table". This allowed me to exclude<sup>1</sup> certain columns so that we could manually calculate the stats. To make this data usable for our Python program, we must use the same dropdown to choose "Get table as CSV". Once the table converts to a text format on the website, copy and paste all 1000+ rows into the .csv we created in the section above based on which table you collected from. The batter data from Baseball Reference goes into the batter_data.csv file and the same with the pitcher data.</p><p>Good job! You just learned how to do simple data collection. Note that if want to present this data in any form to reference the source you got it from. This applies to anything you find on the Internet!</p><p>For this article, I changed some things up so that your program only analyzes around 10 players at a time instead of all 1,000.&nbsp; You can download those "partial data" .csv files I used through my GitHub:&nbsp;<a href="https://github.com/Baseballfan5303/VS-BlogWebsite/tree/main/BlogArticles/AutomatedBaseballStats"><u>https://github.com/Baseballfan5303/VS-BlogWebsite/tree/main/BlogArticles/AutomatedBaseballStats</u></a>. Using only a part of the large dataset allows testing the Python program to be quicker and easier.</p><p><strong>Finding formulas</strong></p><p>Before we go through the code, we need to find the formulas to calculate our desired stats. The website we will use for this is Fangraphs (<a href="https://library.fangraphs.com/"><u>https://library.fangraphs.com/</u></a>). Use the search bar to type in each stat in order to find the proper formula to use.</p><p><strong>Creating the program</strong></p><p>I have added the code to both the batter and pitcher stat programs in the same GitHub location as above. Please feel free to download the .py files and use/test with them; you will want to save the Python files in the same folder you created in step 1 and added the .csv files to. You might be wondering how I came up with this program what each section of the program means, and what we are getting as output. Well, let me explain.</p><p>Batting Stats:</p><p></p><ul><li>We want to find batting average (AVG), on-base percentage (OBP), slugging percentage (SLG), on-base + slugging (OPS), batting average on balls in play (BABIP), total bases (TB), and isolated power (ISO).</li><li>First, we <em>import csv</em> so we can read a .csv file.</li><li>We then define our variables which are the stats we want to find. <em>singles </em>is a global variable because we need to calculate this stat for TB.</li><li>The <em>playerStats</em>&nbsp;array contains each batter's stats as we iterate through our .csv rows. Each index value of the array represents a stat column.</li><li>The function <em>open(file, mode) </em>in Line 22 allows use to read our partial data .csv file. Make sure the file we are opening is the "batter_partial_data.csv"!</li><li>Line 23 sets <em>myData</em>&nbsp;as the .csv reader; <em>myData </em>represents the rows of the sheet.</li><li>Line 24 starts our for loop iteration through the rows of the sheet. The <em>playerStats</em>&nbsp;array becomes <em>rw </em>in Line 26.</li><li>Lines 29-37 set the variables our formulas require by referencing an index value of <em>playerStats </em>based on the column headers in the csv. For example, <em>ab = int(playerStats[7])</em>&nbsp;means at bats = the integer value of the 8th column in this row of data.</li><li>In lines 40-50, we perform our calculations. Setting our variables in Lines 29-37 allow us to change index values for our formulas in only one place, instead of multiple.</li><li>For batters, decimal stats are rounded to three decimal places, hence the <em>round(...,3)</em>&nbsp;function being used.</li><li>Line 53 prints the batter's name in the row we are currently iterating through.</li><li>Lines 54-60 print the batter's stats.</li></ul><p>Pitching Stats (anything listed as explaining the pitching stats program differs from the batting stats program):</p><p></p><ul><li>We want to find earned run average (ERA), adjusted earned run average (ERA+), fielding independent pitching (FIP), walks + hits per inning (WHIP).</li><li>When defining our variables, we need the league ERA in 2019,&nbsp;<em>lg_era</em>&nbsp;(4.49 in 2019), for ERA+ and a constant for the FIP formula,&nbsp;<em>fip_const</em>&nbsp;(generally 3.1).</li><li>Be sure to use the "pitcher_partial_data.csv" file in line 20!</li><li>Notice that we are getting different variables and index values in lines 27-33. This is because the formulas for our desired pitching stats are different from the batting stats.</li></ul><p></p><hr>Voila! You have now become an automated baseball statistician! We used data in the form of a .csv, ran it through a Python program, and got desired statistics outputted!<p></p><p>I encourage you to play around with different sets of data, try to calculate even more stats, and even try to repeat this process for another sport! Remember to manually change the file being read in each program and any constants that might change from year to year.</p><p>Good luck with your data collecting and programming!</p><p><strong><em>-Andrew</em></strong></p><p></p><hr><p></p><p><sup>1</sup>&nbsp;Excluded from batter data I collected: AVG, OBP, SLG, TB; Excluded from pitcher data I collected: ERA, ERA+, FIP, WHIP</p>
